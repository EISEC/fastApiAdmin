# โ ะกะธััะตะผะฐ ะบะฐัะบะฐะดะฝะพะณะพ ัะดะฐะปะตะฝะธั ัะฐะนัะพะฒ ะฝะฐัััะพะตะฝะฐ

## ๐ ะงัะพ ัะตะฐะปะธะทะพะฒะฐะฝะพ:

### ๐ง ะะฒัะพะผะฐัะธัะตัะบะพะต ะบะฐัะบะฐะดะฝะพะต ัะดะฐะปะตะฝะธะต
ะัะธ ัะดะฐะปะตะฝะธะธ ัะฐะนัะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะดะฐะปััััั:
- โ ะัะต ะฟะพััั ัะฐะนัะฐ (`on_delete=models.CASCADE`)
- โ ะัะต ัััะฐะฝะธัั ัะฐะนัะฐ (`on_delete=models.CASCADE`)  
- โ ะัะต ะบะฐัะตะณะพัะธะธ ัะฐะนัะฐ (`on_delete=models.CASCADE`)
- โ ะัะต ัะตะณะธ ัะฐะนัะฐ (`on_delete=models.CASCADE`)
- โ ะัะต ะดะธะฝะฐะผะธัะตัะบะธะต ะผะพะดะตะปะธ ัะฐะนัะฐ (`on_delete=models.CASCADE`)
- โ ะกะฒัะทะธ ั ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ ะพัะธัะฐัััั ะฐะฒัะพะผะฐัะธัะตัะบะธ
- โ ะคะฐะนะปั ะธะทะพะฑัะฐะถะตะฝะธะน ัะฐะนัะฐ ัะดะฐะปััััั ัะตัะตะท ัะธะณะฝะฐะปั

### ๐ก๏ธ ะะตะทะพะฟะฐัะฝะพััั
- โ๏ธ ะะพะปัะทะพะฒะฐัะตะปะธ ะะ ัะดะฐะปััััั (`on_delete=models.SET_NULL`)
- ๐ ะัะพะฒะตัะบะฐ ะฟัะฐะฒ ะดะพัััะฟะฐ (ัะพะปัะบะพ ะฒะปะฐะดะตะปะตั ะธะปะธ ััะฟะตัะฟะพะปัะทะพะฒะฐัะตะปั)
- ๐ ะขัะฐะฝะทะฐะบัะธะธ ั ะพัะบะฐัะพะผ ะฟัะธ ะพัะธะฑะบะฐั
- ๐ ะะพะปะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ะพะฟะตัะฐัะธะน

### ๐ ะกะฟะพัะพะฑั ะธัะฟะพะปัะทะพะฒะฐะฝะธั:

#### 1. API Endpoints:
```bash
# ะัะตะดะฒะฐัะธัะตะปัะฝัะน ะฟัะพัะผะพัั
GET /api/sites/{id}/delete_preview/

# ะะฐัะบะฐะดะฝะพะต ัะดะฐะปะตะฝะธะต  
DELETE /api/sites/{id}/cascade_delete/
```

#### 2. Management ะบะพะผะฐะฝะดะฐ:
```bash
# ะัะตะดะฒะฐัะธัะตะปัะฝัะน ะฟัะพัะผะพัั
python3 manage.py delete_site_cascade 1 --dry-run

# ะฃะดะฐะปะตะฝะธะต ั ะฟะพะดัะฒะตัะถะดะตะฝะธะตะผ
python3 manage.py delete_site_cascade 1

# ะัะธะฝัะดะธัะตะปัะฝะพะต ัะดะฐะปะตะฝะธะต
python3 manage.py delete_site_cascade 1 --force
```

#### 3. ะัะพะณัะฐะผะผะฝัะน ะฒัะทะพะฒ:
```python
from apps.sites.signals import cascade_delete_site_with_transaction

result = cascade_delete_site_with_transaction(site_id=1)
if result['success']:
    print(f"ะฃะดะฐะปะตะฝ ัะฐะนั: {result['site_name']}")
```

#### 4. ะะฑััะฝะพะต ัะดะฐะปะตะฝะธะต Django:
```python
site = Site.objects.get(id=1)
site.delete()  # ะะฐะฑะพัะฐะตั ะบะฐัะบะฐะดะฝะพ ะฑะปะฐะณะพะดะฐัั ะฝะฐัััะพะนะบะฐะผ
```

## ๐ ะกะพะทะดะฐะฝะฝัะต ัะฐะนะปั:

- `backend/apps/sites/signals.py` - ะกะธะณะฝะฐะปั ะธ ะปะพะณะธะบะฐ ัะดะฐะปะตะฝะธั
- `backend/apps/sites/management/commands/delete_site_cascade.py` - Management ะบะพะผะฐะฝะดะฐ
- `backend/apps/sites/tests_cascade_delete.py` - ะะพะปะฝัะต ัะตััั (9 ัะตััะพะฒ)
- `backend/CASCADE_DELETE_GUIDE.md` - ะะพะดัะพะฑะฝะพะต ััะบะพะฒะพะดััะฒะพ

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต:

```bash
# ะะฐะฟััะบ ัะตััะพะฒ ะบะฐัะบะฐะดะฝะพะณะพ ัะดะฐะปะตะฝะธั
python3 manage.py test apps.sites.tests_cascade_delete -v 2

# ะัะต 9 ัะตััะพะฒ ะฟัะพัะปะธ ััะฟะตัะฝะพ โ
```

## ๐ฏ ะะฝัะตะณัะฐัะธั ั frontend:

ะกะธััะตะผะฐ ะณะพัะพะฒะฐ ะบ ะธะฝัะตะณัะฐัะธะธ ั frontend ัะตัะตะท API endpoints:
- ะัะตะดะฒะฐัะธัะตะปัะฝัะน ะฟัะพัะผะพัั ั ะฟัะตะดัะฟัะตะถะดะตะฝะธัะผะธ
- ะะตะทะพะฟะฐัะฝะพะต ัะดะฐะปะตะฝะธะต ั ะพััะตัะพะผ ะพ ัะตะทัะปััะฐัะฐั
- ะะพะปะฝะฐั ัะธะฟะธะทะฐัะธั ะดะปั TypeScript

---

> **๐ ะะพะดัะพะฑะฝะพะต ััะบะพะฒะพะดััะฒะพ:** `backend/CASCADE_DELETE_GUIDE.md` 