---
description:
globs:
alwaysApply: false
---
# üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

## üìã –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∫ –∏–∑—É—á–µ–Ω–∏—é –ø–µ—Ä–µ–¥ –ª—é–±—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- **[FRONTEND_BACKEND_FIXES.md](../../FRONTEND_BACKEND_FIXES.md)** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- **[TROUBLESHOOTING.md](../../TROUBLESHOOTING.md)** - –ë—ã—Å—Ç—Ä–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º  
- **[DEVELOPER_CHECKLIST.md](../../DEVELOPER_CHECKLIST.md)** - –ß–µ–∫–ª–∏—Å—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
- **[DOCUMENTATION_INDEX.md](../../DOCUMENTATION_INDEX.md)** - –ò–Ω–¥–µ–∫—Å –≤—Å–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

## üîß –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è PostForm

### ‚ùå –ù–ï –î–ï–õ–ê–ô–¢–ï:
```typescript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –±–µ–∑ .or(z.literal(''))
slug: z.string().regex(/^[a-z0-9-]+$/).optional(),
excerpt: z.string().max(500).optional(),

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è site –≤ defaultValues
defaultValues: {
  site: sites[0]?.id || 0,  // –ù–ï –¢–ê–ö!
}
```

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è —Å –ø—É—Å—Ç—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏
slug: z.string()
  .regex(/^[a-z0-9-]+$/, '–¢–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –¥–µ—Ñ–∏—Å—ã')
  .or(z.literal(''))  // ‚úÖ –†–∞–∑—Ä–µ—à–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
  .optional(),
  
excerpt: z.string()
  .max(500, '–ú–∞–∫—Å–∏–º—É–º 500 —Å–∏–º–≤–æ–ª–æ–≤')
  .or(z.literal(''))  // ‚úÖ –†–∞–∑—Ä–µ—à–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
  .optional(),

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ site –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
useEffect(() => {
  if (sites.length > 0 && !isEditing && !watchedSite) {
    setValue('site', sites[0].id, { shouldValidate: true });
  }
}, [sites, isEditing, setValue, watchedSite]);
```

---

## üì∏ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

### ‚ùå –ù–ï –î–ï–õ–ê–ô–¢–ï:
```typescript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: JSON –¥–ª—è —Ñ–∞–π–ª–æ–≤
await api.post('/posts/', {
  ...data,
  featured_image: fileObject  // –ù–ï –¢–ê–ö!
});
```

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: FormData –¥–ª—è —Ñ–∞–π–ª–æ–≤
if (data.featured_image instanceof File) {
  const formData = new FormData();
  
  Object.entries(data).forEach(([key, value]) => {
    if (value !== undefined && value !== null) {
      if (key === 'featured_image' && value instanceof File) {
        formData.append(key, value);
      } else {
        formData.append(key, String(value));
      }
    }
  });
  
  // POST: –∏—Å–ø–æ–ª—å–∑—É–µ–º api.upload()
  newPost = await api.upload<Post>('/posts/', formData);
} else {
  // JSON –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ —Ñ–∞–π–ª–æ–≤
  newPost = await api.post<Post>('/posts/', data);
}
```

---

## üîß –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤

### ‚ùå –ù–ï –î–ï–õ–ê–ô–¢–ï:
```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ source –¥–ª—è –æ–¥–Ω–æ–∏–º–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—è
class PostListSerializer(serializers.ModelSerializer):
    tags = TagSerializer(source='tags', many=True, read_only=True)  # –ù–ï –¢–ê–ö!
```

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
```python
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ë–µ–∑ –ª–∏—à–Ω–µ–≥–æ source
class PostListSerializer(serializers.ModelSerializer):
    tags = TagSerializer(many=True, read_only=True)  # –¢–ê–ö!
    tags_list = TagSerializer(source='tags', many=True, read_only=True)  # –ï—Å–ª–∏ –Ω—É–∂–µ–Ω –∞–ª–∏–∞—Å
```

---

## üåê –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ API endpoints

### ‚ùå –ù–ï –î–ï–õ–ê–ô–¢–ï:
```typescript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ï –ø—É—Ç–∏
fetchCategories: () => api.get('/categories/'),        // –ù–ï –¢–ê–ö!
fetchTags: () => api.get('/tags/'),                    // –ù–ï –¢–ê–ö!
changeStatus: (id, status) => api.patch(`/posts/${id}/`, { status }),  // –ù–ï –¢–ê–ö!
```

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ï –ø—É—Ç–∏
fetchCategories: () => api.get('/posts/categories/'),  // –¢–ê–ö!
fetchTags: () => api.get('/posts/tags/'),              // –¢–ê–ö!
changeStatus: (id, status) => api.patch(`/posts/${id}/change_status/`, { status }),  // –¢–ê–ö!
```

---

## üß™ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º

### ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ —Å —Ñ–∞–π–ª–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ –±–µ–∑ —Ñ–∞–π–ª–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç  
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π/—Ç–µ–≥–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö backend

### üõ† –ö–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
# Backend
cd backend
python3 manage.py check
python3 manage.py test

# Frontend  
cd frontend
yarn type-check
yarn build
```

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø

### üî¥ –ù–ï –ò–ó–ú–ï–ù–Ø–ô–¢–ï –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π:
1. `frontend/src/store/postsStore.ts` - –õ–æ–≥–∏–∫–∞ FormData
2. `frontend/src/components/forms/PostForm.tsx` - Zod —Å—Ö–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏  
3. `backend/apps/posts/serializers.py` - –ü–æ–ª—è tags –±–µ–∑ source
4. API endpoints –ø—É—Ç–∏ –≤ frontend stores

### ‚ö†Ô∏è –í–°–ï–ì–î–ê –ü–†–û–í–ï–†–Ø–ô–¢–ï:
1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ —Å —Ñ–∞–π–ª–∞–º–∏ –∏ –±–µ–∑ —Ñ–∞–π–ª–æ–≤
2. –í–∞–ª–∏–¥–∞—Ü–∏—é –≤—Å–µ—Ö —Ñ–æ—Ä–º –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏/–ª–æ–≥–∞—Ö
4. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Ç–∏–ø–æ–≤ frontend-backend

---

## üìù –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Pull Request

### ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```markdown
## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ —Å —Ñ–∞–π–ª–æ–º: ‚úÖ/‚ùå
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ –±–µ–∑ —Ñ–∞–π–ª–∞: ‚úÖ/‚ùå  
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞: ‚úÖ/‚ùå
- [ ] –°–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å–∞: ‚úÖ/‚ùå
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π/—Ç–µ–≥–æ–≤: ‚úÖ/‚ùå
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã: ‚úÖ/‚ùå

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–µ—Å–ª–∏ –∏–∑–º–µ–Ω—è–ª–∏—Å—å)
- backend/apps/posts/serializers.py
- frontend/src/store/postsStore.ts  
- frontend/src/components/forms/PostForm.tsx
```

---

> **üíÄ –í–ù–ò–ú–ê–ù–ò–ï:** –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–∏—Ö –ø—Ä–∞–≤–∏–ª –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ–ª–æ–º–∫–µ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å—Ç–æ–≤!
